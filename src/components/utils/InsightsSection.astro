---
import { getPosts } from "@/lib/wp";

// cantidad de posts a mostrar
const posts = await getPosts({ perPage: 10 });
---

<section id="blog" class="bg-card/20 py-10 lg:py-32">
  <div class="container mx-auto px-4">
    <!-- Header -->
    <div class="mb-12 text-center">
      <h2 class="font-headline text-4xl font-bold tracking-tight sm:text-5xl">
        Insights & Contenido
      </h2>
      <p class="mx-auto mt-4 max-w-2xl text-lg text-muted-foreground">
        Explora nuestras ideas sobre tecnología, educación y mejora continua.
      </p>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
      {posts.map((post) => (
        <a href={`/blog/${post.slug}`} class="block">
          <article
            class="flex h-full flex-col overflow-hidden rounded-lg border border-border bg-card transition-all duration-300
                   hover:-translate-y-2 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/10"
          >
            <!-- Imagen destacada -->
            {post.featureImage && (
              <div class="aspect-video overflow-hidden">
                <img
                  src={post.featureImage}
                  alt={post.title}
                  loading="lazy"
                  class="h-full w-full object-cover transition-transform duration-300 hover:scale-105"
                />
              </div>
            )}

            <!-- Contenido -->
            <div class="flex flex-1 flex-col p-6">
              <!-- Fecha -->
              <span class="mb-2 text-sm text-muted-foreground">
                {new Date(post.date).toLocaleDateString("es-CL", {
                  year: "numeric",
                  month: "short",
                  day: "numeric",
                })}
              </span>

              <!-- Título -->
              <h3 class="font-headline text-xl font-semibold">
                {post.title}
              </h3>

              <!-- Extracto -->
              <div
                class="mt-2 line-clamp-3 text-muted-foreground prose prose-sm max-w-none"
                set:html={post.excerpt}
              />

              <div class="mt-auto pt-4">
                <span class="text-sm font-medium text-primary">
                  Leer más →
                </span>
              </div>
            </div>
          </article>
        </a>
      ))}
    </div>
  </div>
</section>
