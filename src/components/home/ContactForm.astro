---
/* ContactForm.astro */
---

<form id="contact-form" class="space-y-6">
  <!-- Nombre -->
  <div>
    <label for="name" class="block text-sm font-medium mb-1">
      Nombre
    </label>
    <input
      id="name"
      name="name"
      type="text"
      required
      minlength="2"
      placeholder="Tu nombre"
      class="w-full rounded-md border border-white/10 bg-background px-4 py-3 text-foreground
             focus:outline-none focus:ring-2 focus:ring-primary"
    />
    <p class="hidden text-sm text-red-500 mt-1" data-error="name">
      El nombre debe tener al menos 2 caracteres.
    </p>
  </div>

  <!-- Email -->
  <div>
    <label for="email" class="block text-sm font-medium mb-1">
      Correo
    </label>
    <input
      id="email"
      name="email"
      type="email"
      required
      placeholder="tu@correo.com"
      class="w-full rounded-md border border-white/10 bg-background px-4 py-3 text-foreground
             focus:outline-none focus:ring-2 focus:ring-primary"
    />
    <p class="hidden text-sm text-red-500 mt-1" data-error="email">
      Por favor, introduce un correo válido.
    </p>
  </div>

  <!-- Mensaje -->
  <div>
    <label for="message" class="block text-sm font-medium mb-1">
      Mensaje
    </label>
    <textarea
      id="message"
      name="message"
      required
      minlength="10"
      placeholder="¿En qué podemos ayudarte?"
      class="w-full min-h-[120px] rounded-md border border-white/10 bg-background px-4 py-3 text-foreground
             focus:outline-none focus:ring-2 focus:ring-primary"
    ></textarea>
    <p class="hidden text-sm text-red-500 mt-1" data-error="message">
      El mensaje debe tener al menos 10 caracteres.
    </p>
  </div>

  <!-- Submit -->
  <button
    type="submit"
    class="w-full rounded-md bg-primary py-4 text-lg font-bold text-black
           hover:opacity-90 transition"
  >
    Enviar Mensaje
  </button>

  <!-- Success -->
  <p
    id="success-message"
    class="hidden text-center text-sm text-green-500 font-medium"
  >
    ✅ Mensaje enviado correctamente. ¡Gracias por contactarnos!
  </p>
</form>

<script>
  const form = document.getElementById("contact-form");
  const successMessage = document.getElementById("success-message");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    // Validación nativa
    if (!form.checkValidity()) {
      form.querySelectorAll("[data-error]").forEach(el => el.classList.add("hidden"));

      if (!form.name.checkValidity()) {
        form.querySelector('[data-error="name"]').classList.remove("hidden");
      }
      if (!form.email.checkValidity()) {
        form.querySelector('[data-error="email"]').classList.remove("hidden");
      }
      if (!form.message.checkValidity()) {
        form.querySelector('[data-error="message"]').classList.remove("hidden");
      }

      return;
    }

    // Simulación de envío
    console.log({
      name: form.name.value,
      email: form.email.value,
      message: form.message.value,
    });

    form.reset();
    successMessage.classList.remove("hidden");
  });
</script>
